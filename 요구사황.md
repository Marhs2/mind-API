- **작성일**: 2025년 8월 28일
- **버전**: 0.4
- **작성자**: 팀장: 김영찬, 팀원: 정동일, 여권우

## 1. 프로젝트 개요

본 문서는 온라인 상담 설문 시스템 구축을 위한 사용자 요구사항을 정의합니다.
본 시스템은 사용자가 상담을 받을 때마다 상담 전·후 설문을 작성하고, 이를 통해 심리 상태의 변화를 기록하는 것을 목표로 합니다.
상담사(관리자)는 이 데이터를 바탕으로 사용자를 개별 관리할 수 있고, 사용자 또한 자신의 변화를 시각적으로 확인할 수 있습니다.

### 특징

- **로그인**: 구글 계정 로그인 (Google OAuth2.0)
- **주요 기능 (상담사)**: 상담 이력 관리, 본인 설문 결과 통계 확인, 사용자 관리, 기본/커스텀 설문 관리, 전체 통계 분석
- **데이터**: 상담 횟수별 설문 데이터 누적을 통해 개인별 변화 확인 및 집단 통계 분석 지원

## 2. 이해 관계자

- **사용자 (User)**: 상담을 받고, 상담 전·후 설문을 작성하며 본인 데이터의 통계 추이를 확인하는 사람.
- **상담사 (Administrator)**: 상담과 시스템 관리를 담당 (사용자, 설문, 통계 관리).

## 3. 기능 요구사항 (Functional Requirements)

### 3.1. 사용자 기능 요약

| ID | 유저 스토리 | 우선순위 |
| --- | --- | --- |
| US-000 | 사용자로서, 별도 회원가입 없이 구글 계정 로그인을 통해 시스템에 접속할 수 있다. | Must-have |
| US-001 | 사용자로서, 로그인 후 나의 상담 이력과 설문 기록을 확인할 수 있다. | Must-have |
| US-002 | 사용자로서, 상담 시작 전 Before 설문을 작성할 수 있다. | Must-have |
| US-003 | 사용자로서, 상담 직후 After 설문을 작성할 수 있다. | Must-have |
| US-004 | 사용자로서, 상담 횟수별 설문 결과를 누적 그래프로 확인할 수 있다. | Should-have |
| US-005 | 사용자로서, 내 설문 결과를 바탕으로 개인 평균값과 Before/After 변화 추이를 확인할 수 있다. | Should-have |

### 3.2. 상담사(관리자) 기능 요약

| ID | 유저 스토리 | 우선순위 |
| --- | --- | --- |
| CS-000 | 상담사로서, 사전에 등록된 이메일로만 구글 로그인 접속 및 관리자 권한을 부여받을 수 있다. | Must-have |
| CS-001 | 상담사로서, 사용자 계정을 등록·관리할 수 있다. | Must-have |
| CS-002 | 상담사로서, 사용자의 상담 횟수별 Before/After 설문 결과를 확인하고 비교할 수 있다. | Must-have |
| CS-003 | 상담 전·후 설문 작성 요청 알림을 이메일로 발송할 수 있다. | Must-have |
| CS-004 | 상담사로서, 전체 사용자의 설문 데이터를 종합하여 통계를 확인할 수 있다. | Must-have |
| CS-005 | 상담사로서, 회원 관리(계정 수정·비활성화 등)를 수행할 수 있다. | Must-have |
| CS-006 | 상담사로서, 나만의 커스텀 설문 문항을 생성·수정·삭제할 수 있다. | Must-have |
| CS-007 | 상담사로서, 통계 분석 시 특정 문항을 평균 계산에 반영할지 여부를 선택할 수 있다. | Must-have |
| CS-008 | 상담사로서, 사용자별 및 집단별 평균값과 설문 변화 추이를 그래프로 확인할 수 있다. | Should-have |

### 3.3. 사용자 기능 상세

- **US-000 (구글 계정 로그인)**
    - **UI/UX**: 시스템 접속 시 ‘구글 계정으로 로그인’ 버튼을 제공한다.
    - **기능**:
        - 버튼 클릭 시 Google OAuth 2.0 인증 페이지로 리디렉션한다.
        - 인증 성공 시, 시스템은 구글 계정 정보를 바탕으로 사용자를 식별하고 로그인 상태를 유지한다.
        - 신규 사용자의 경우, 최초 로그인 시 사용자 프로필(이름, 이메일)을 시스템에 자동 등록한다.
- **US-001 (상담 이력 및 설문 기록 확인)**
    - **UI/UX**: 로그인 후 메인 대시보드에서 ‘나의 상담 이력’ 섹션을 제공한다.
    - **기능**:
        - 상담 횟수, 날짜, Before/After 설문 완료 여부를 목록 형태로 표시한다.
        - 각 상담 기록을 클릭하면 해당 상담의 상세 설문 데이터와 통계 화면으로 이동한다.
- **US-002, US-003 (Before/After 설문 작성)**
    - **UI/UX**:
        - 상담 전/후 설문 작성을 위한 전용 페이지를 제공한다.
        - 페이지 내에 8개 감정 타입(우울함, 불안, 기쁨, 분노, 피로, 외로움, 안정감, 자기만족도)에 대한 질문과 함께 0점에서 10점까지 선택 가능한 슬라이더 UI를 제공한다.
        - 사용자가 필요에 따라 추가 의견을 작성할 수 있는 텍스트 입력란을 제공한다.
        - 모든 문항 작성 후 ‘제출하기’ 버튼을 제공한다.
    - **기능**:
        - 사용자가 설문을 완료하고 제출 시, 해당 데이터는 상담 회차와 Before/After 타입으로 구분되어 데이터베이스에 저장된다.
        - 설문 제출 후, 사용자는 완료 페이지로 이동하며 자신의 최신 설문 결과를 즉시 확인할 수 있다.
- **US-004, US-005 (통계 시각화)**
    - **UI/UX**:
        - 대시보드 내 ‘나의 통계’ 섹션을 제공하거나, 별도의 ‘통계 분석’ 페이지로 연결한다.
        - **라인 차트**: 상담 횟수(X축)에 따른 8개 감정 점수(Y축) 변화를 여러 라인으로 시각화한다.
        - **레이더 차트**: 가장 최근 설문 결과를 기반으로 8개 감정 상태의 균형을 한눈에 보여준다.
        - **Before/After 비교**: 각 상담 회차별 상담 전/후의 감정 점수 변화를 그룹 막대 그래프로 비교하여 보여준다.
        - **평균 대시보드**: 개인의 전체 상담 기간 동안의 8개 감정별 평균 점수를 목록 형태로 표시한다.
    - **기능**:
        - 사용자가 데이터를 조회할 때마다 실시간으로 데이터를 계산하여 차트에 반영한다.
        - 차트 상호작용 (예: 마우스 오버 시 특정 데이터 포인트 상세 정보 표시) 기능을 제공한다.

### 3.4. 상담사(관리자) 기능 상세

- **CS-000 (관리자 구글 로그인)**
    - **UI/UX**: 사용자 로그인과 동일한 구글 로그인 버튼을 사용한다.
    - **기능**:
        - 로그인 시도 시, 시스템은 사용자의 이메일 주소를 사전에 등록된 관리자 이메일 목록과 대조하여 관리자 권한을 부여한다.
        - 등록되지 않은 이메일의 경우, 일반 사용자 권한으로 접속되거나, ‘접근 권한이 없습니다’라는 메시지를 표시한다.
- **CS-001, CS-005 (사용자 관리)**
    - **UI/UX**: ‘사용자 관리’ 메뉴에서 사용자 목록 테이블을 제공한다.
    - **테이블 내용**: 사용자 ID, 이름, 가입일, 마지막 상담일, 상태(활성화/비활성화) 등.
    - **기능**:
        - 사용자 이름 또는 ID로 검색/필터링할 수 있는 기능을 제공한다.
        - 각 사용자 옆에 ‘상세 보기’, ‘계정 비활성화’ 등의 버튼을 제공한다.
        - ‘상세 보기’ 클릭 시 해당 사용자의 상담 이력 및 통계 화면으로 이동한다.
        - ‘비활성화’ 버튼 클릭 시 사용자 계정의 로그인 및 데이터 접근을 차단한다.
- **CS-002 (사용자 설문 결과 확인)**
    - **UI/UX**: 특정 사용자의 상세 페이지에서 상담 회차별 설문 데이터를 조회할 수 있는 테이블을 제공한다.
    - **기능**:
        - 상담 회차별로 Before/After 설문 점수와 변화량을 한눈에 확인할 수 있다.
        - ‘상세 보기’ 클릭 시, 해당 상담의 전체 8개 감정 점수와 사용자가 남긴 의견을 확인할 수 있다.
- **CS-003 (설문 요청 알림 발송)**
    - **UI/UX**: 사용자 상세 페이지 또는 상담 관리 페이지에 ‘설문 요청 이메일 발송’ 버튼을 제공한다.
    - **기능**:
        - 버튼 클릭 시, 해당 사용자에게 설문 링크가 포함된 이메일 알림을 즉시 발송한다.
        - 메일 내용에는 상담 전 설문(Before) 또는 상담 후 설문(After)을 작성하라는 명확한 지침이 포함되어야 한다.
- **CS-004, CS-008 (전체 통계 분석)**
    - **UI/UX**: ‘전체 통계 분석’ 대시보드를 제공한다.
    - **기능**:
        - **전체 평균 비교**: 개인 평균과 전체 평균을 비교하는 막대 그래프를 제공한다.
        - **집단 트렌드 분석**: 전체 사용자의 월별/주별 감정 변화 추이를 라인 차트로 보여준다.
        - **히스토그램**: 각 감정 타입별 점수 분포를 히스토그램으로 보여준다.
        - **상관관계 분석**: 8개 감정 타입 간의 상관관계를 보여주는 히트맵을 제공한다.
        - **필터링 기능**: 연령, 직업 등 추가 논의가 필요한 속성으로 데이터를 필터링할 수 있는 드롭다운 메뉴를 제공한다.
- **CS-006 (커스텀 설문 문항 관리)**
    - **UI/UX**: ‘설문 관리’ 메뉴에서 ‘새 설문 생성’ 버튼과 기존 설문 목록 테이블을 제공한다.
    - **기능**:
        - **생성**: 설문 제목, 각 문항의 질문 텍스트, 점수 범위 등을 입력할 수 있는 폼을 제공한다.
        - **수정/삭제**: 기존 설문 목록에서 수정 또는 삭제 기능을 제공한다.
        - 커스텀 설문은 특정 사용자에게만 할당하여 사용될 수 있다.
- **CS-007 (선택적 통계 계산)**
    - **UI/UX**: 전체 통계 대시보드 내에 8개 감정 타입 목록과 각 항목 옆에 체크박스를 제공한다.
    - **기능**:
        - 상담사가 체크박스를 선택하거나 해제할 때마다, 선택된 항목들의 평균값이 실시간으로 재계산되어 표시된다.
        - 이 기능을 통해 긍정 감정 평균, 부정 감정 평균 등 다양한 맞춤형 분석이 가능하다.

## 4. 비기능 요구사항 (NFRs)

- **4.1. 성능**
    - 설문 저장/조회: 3초 이내 응답
    - 동시 사용자 수: 최소 10명 지원
- **4.2. 보안**
    - 구글 OAuth2.0 기반 로그인 (패스워드 저장 불필요)
    - 개인정보보호법 준수
- **4.3. 사용성**
    - 직관적이고 간단한 UI
    - 사용자도 본인의 변화를 쉽게 확인할 수 있는 시각화 통계 화면 제공
    - 모바일 환경에서 설문 입력 및 통계 확인 가능
    - 웹 표준 및 웹 접근성 지침 준수
- **4.4. 확장성**
    - 설문 데이터 10배 증가에도 성능 유지
    - 설문 문항 추가 및 통계 모듈 확장 용이
- **4.5. 유지보수성**
    - 코드 컨벤션 준수
    - 활동 로그 및 버전 관리 체계 보유
- **4.6. 제약사항**
    - **일정**: 10주 이내 1차 버전 완성
    - **기술 스택**: Front: HTML, CSS, JS / Back-end: Spring Boot / DB: Oracle
    - **법규 준수**: 개인정보보호법 및 관련 규정

## 5. 미정 및 논의 필요

- **통계 범위**: 상담사의 집단 통계 분석 시 속성별(예: 연령/직업 등) 비교를 추가할지 여부.

## 6. 설문 및 통계 시스템 상세 정의

### 6.1. 8개 감정 타입 설문 구조

시스템의 핵심인 감정 상태 측정을 위한 8개 감정 타입과 설문 구조는 다음과 같습니다:

| 감정 타입 | 측정 범위 | 설문 문항 예시 |
| --- | --- | --- |
| 우울함 | 0~10점 | “지난 일주일 동안 우울하거나 절망적인 기분을 얼마나 자주 느끼셨나요?” |
| 불안 | 0~10점 | “현재 미래에 대한 걱정이나 불안감을 어느 정도 느끼고 계신가요?” |
| 기쁨 | 0~10점 | “최근 즐겁거나 행복한 감정을 얼마나 자주 경험하셨나요?” |
| 분노 | 0~10점 | “지난 일주일 동안 화나거나 짜증이 난 정도는 어느 정도였나요?” |
| 피로 | 0~10점 | “현재 신체적, 정신적 피로감을 어느 정도 느끼고 계신가요?” |
| 외로움 | 0~10점 | “최근 혼자라는 느낌이나 고립감을 어느 정도 경험하셨나요?” |
| 안정감 | 0~10점 | “현재 마음의 평온함과 안정감을 어느 정도 느끼고 계신가요?” |
| 자기만족도 | 0~10점 | “현재 자신에 대한 만족도와 자존감 수준은 어느 정도인가요?” |

### 6.2. 통계 분석 시스템 상세 (CS-007, CS-008 구체화)

### 6.2.1. 선택적 통계 계산 기능 (CS-007)

**기능 설명:**
상담사가 전체 통계 분석 시, 8개 감정 타입 중 특정 감정들만 선택하여 평균값을 계산할 수 있습니다.

- **예시**:
    - **부정적 감정 평균**: (우울함, 불안, 분노, 외로움 중 선택한 감정들의 점수 합산) / 선택한 감정의 개수
    - **긍정적 감정 평균**: (기쁨, 안정감, 자기만족도 중 선택한 감정들의 점수 합산) / 선택한 감정의 개수

**구현 방식 상세:**

- UI는 8개 감정 타입별로 체크박스를 제공하며, 사용자가 원하는 감정을 선택/해제할 수 있도록 구현합니다.
- 선택된 감정들의 평균값은 실시간으로 계산하여 화면에 표시합니다.
- 통계 분석 시 특정 선택 설정을 저장하여 추후 분석 시에도 일관된 기준을 적용할 수 있도록 합니다.

### 6.2.2. 통계 시각화 시스템 (CS-008)

**개인별 통계 기능 상세:**

1. **라인 차트 (Line Chart)**
    - **표시 내용**: 사용자 개인의 상담 횟수별 8개 감정 점수 변화 추이
    - **축 구성**:
        - **X축**: 상담 횟수 (예: 1회차, 2회차, ...)
        - **Y축**: 감정 점수 (0점부터 10점까지)
    - **시각화**: 8개 감정 각각을 고유한 색상의 라인으로 표시하여 한눈에 변화 추이를 확인할 수 있도록 합니다.
2. **레이더 차트 (Radar Chart)**
    - **표시 내용**: 가장 최근 상담 시점의 8개 감정 상태 종합 보기
    - **축 구성**: 원의 중심에서 8개 방향으로 뻗은 축 (각각 8개 감정 타입)
    - **시각화**: 각 축에 점수를 표시하고, 점들을 연결하여 다각형 형태로 나타냅니다. 다각형의 형태를 통해 사용자의 감정 상태 균형을 직관적으로 보여줍니다.
3. **Before/After 비교 차트**
    - **표시 내용**: 각 상담 세션의 상담 전·후 감정 변화
    - **축 구성**:
        - **X축**: 8개 감정 타입
        - **Y축**: 감정 점수 (0점부터 10점까지)
    - **시각화**: 각 감정 타입에 대해 ‘상담 전’ 점수와 ‘상담 후’ 점수를 비교하는 막대 그래프 또는 그룹 막대 그래프로 표시합니다.
4. **평균 점수 대시보드**
    - **표시 내용**: 사용자의 전체 상담 이력에 대한 감정별 평균 점수
    - **시각화**: 감정 타입 목록과 각 감정의 평균 점수를 목록 또는 가로 막대 그래프로 표시합니다.

**집단별 통계 기능 상세:**

1. **전체 평균 비교 차트**
    - **표시 내용**: 특정 사용자의 감정별 평균 점수와 전체 사용자 집단의 평균 점수 비교
    - **시각화**: 각 감정 타입에 대해 개인 평균과 집단 평균을 나란히 배치하는 막대 그래프로 표시합니다.
2. **집단 트렌드 분석 차트**
    - **표시 내용**: 전체 사용자 집단의 월별 또는 주별 평균 감정 변화 추이
    - **시각화**: 각 감정 타입별로 시간 흐름에 따른 평균 점수를 라인 차트로 표시합니다.
3. **감정 분포도 (히스토그램)**
    - **표시 내용**: 각 감정 타입별 점수 분포
    - **시각화**: 0점부터 10점까지의 점수 구간에 해당하는 사용자의 수를 막대 그래프(히스토그램)로 표시하여 특정 점수대에 사용자가 얼마나 많이 분포하는지 보여줍니다.
4. **상관관계 분석 (Heatmap)**
    - **표시 내용**: 8개 감정 타입 간의 상관관계
    - **시각화**: 매트릭스 형태로 각 감정 쌍의 상관관계를 색상으로 표시합니다.

### 6.3. 설문 결과 예시 및 통계 활용

### **설문 결과 샘플:**

| 감정 | 상담 전 점수 | 상담 후 점수 | 변화량 | 개인 평균 | 전체 평균 |
| --- | --- | --- | --- | --- | --- |
| 우울함 | 7 | 4 | -3 ↓ | 5.2 | 4.8 |
| 불안 | 8 | 6 | -2 ↓ | 6.8 | 5.5 |
| 기쁨 | 2 | 5 | +3 ↑ | 4.1 | 5.2 |
| 분노 | 6 | 3 | -3 ↓ | 3.5 | 3.2 |
| 피로 | 9 | 7 | -2 ↓ | 7.3 | 6.1 |
| 외로움 | 8 | 6 | -2 ↓ | 6.9 | 5.8 |
| 안정감 | 3 | 6 | +3 ↑ | 4.8 | 6.0 |
| 자기만족도 | 3 | 5 | +2 ↑ | 4.2 | 5.4 |

### **통계 활용 예시 (계산식 포함):**

- **개인 진전도 분석**
    - **부정 감정 평균**: $(우울+불안+분노+외로움)  4 = $ 상담 전 (7+8+6+8)÷4=7.25 → 상담 후 (4+6+3+6)÷4=4.75 (개선도 34.5%)
    - **긍정 감정 평균**: $(기쁨+안정감+자기만족도) 3 = $ 상담 전 (2+3+3)÷3=2.67 → 상담 후 (5+6+5)÷3=5.33 (개선도 99.6%)
- **집단 비교 분석**
    - **개인이 전체 평균 대비 취약한 영역 식별**: 특정 감정(예: 피로 7.3 vs 전체 6.1)의 평균 점수를 비교하여 취약 영역을 파악합니다.
    - **상담 효과성 측정**: 전체 사용자의 상담 전후 평균 점수 변화량과 비교하여 상담 효과를 검증합니다.
- **상담사 관리 도구**
    - **위험군 사용자 조기 발견**: 특정 감정 점수가 8점 이상 지속될 경우 알림을 제공합니다.
    - **상담 효과 검증**: Before/After 점수 변화량을 추적하여 상담이 효과적이었는지 확인합니다.